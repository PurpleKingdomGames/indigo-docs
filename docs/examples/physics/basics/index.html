<!DOCTYPE html>
<html lang="en">
  
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Typelevel Laika + Helium Theme" />
  <title>Basic Physics Example</title>
  
  
  <meta name="description" content="An FP game engine for Scala."/>
  
  
  
  <link rel="icon" sizes="32x32" type="image/png" href="../../../img/favicon.png"/>
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700">
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono:500">
  
  <link rel="stylesheet" type="text/css" href="../../../helium/site/icofont.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../helium/site/laika-helium.css" />
    <link rel="stylesheet" type="text/css" href="../../../css/custom.css" />
  <script src="../../../helium/site/laika-helium.js"></script>
  
  
  <script> /* for avoiding page load transitions */ </script>
</head>

  <body>

    <header id="top-bar" class="light-default dark-default">

  <div class="row">
    <a id="nav-icon">
      <i class="icofont-laika navigationMenu" title="Navigation">&#xefa2;</i>
    </a>
    
    
  </div>

  <a class="image-link" href="../../../documentation/"><img src="../../../img/indigo_logo_solid_text.svg" alt="An FP game engine for Scala." title="Indigo" width="150" height="50"></a>

  <div class="row links">
    
    <a class="button-link" href="https://purplekingdomgames.github.io/indigo-docs/demos">Live Demos</a>
    
    <a class="button-link" href="https://discord.gg/b5CD47g">Discord</a>
    
    <a class="button-link" href="https://github.com/PurpleKingdomGames/indigo">Github</a>
    
  </div>  

</header>
    
    <nav id="sidebar">

  <div class="row">
    
    <a class="button-link" href="https://purplekingdomgames.github.io/indigo-docs/demos">Live Demos</a>
    
    <a class="button-link" href="https://discord.gg/b5CD47g">Discord</a>
    
    <a class="button-link" href="https://github.com/PurpleKingdomGames/indigo">Github</a>
    
  </div>

  <ul class="nav-list">
    <li class="level1 nav-node"><a href="../../../documentation/">Indigo</a></li>
    <li class="level2 nav-header">Setup &amp; Configuration</li>
    <li class="level3 nav-leaf"><a href="../../../documentation/01-quickstart/examples.html">Examples, Demos, and References</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/01-quickstart/extensions-and-libs.html">Extensions, Libraries, and Related Projects</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/01-quickstart/hello-indigo.html">Hello, Indigo!</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/01-quickstart/project-templates.html">Mill &amp; SBT Templates</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/01-quickstart/quickstart.html">Quick start</a></li>
    <li class="level2 nav-header">Guides</li>
    <li class="level3 nav-leaf"><a href="../../../documentation/02-guides/howto-custom-entity.html">How to make a custom entity</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/02-guides/howto-fire-shader.html">How to write a fire shader</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/02-guides/howto-hello-indigo-tyrian.html">How to make a responsive UI using Tyrian</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/02-guides/howto-indigo-game.html">Converting <code>IndigoSandbox</code> to <code>IndigoGame</code></a></li>
    <li class="level2 nav-header">Gameloop</li>
    <li class="level3 nav-leaf"><a href="../../../documentation/03-gameloop/events.html">Events</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/03-gameloop/frame-context.html">Frame context</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/03-gameloop/outcome.html">Outcome Type</a></li>
    <li class="level2 nav-header">Organisation</li>
    <li class="level3 nav-leaf"><a href="../../../documentation/04-organisation/boot-and-start-up.html">Boot &amp; Start Up</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/04-organisation/game-entry-points.html">Game Entry Points</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/04-organisation/scene-management.html">What are Scenes?</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/04-organisation/subsystems.html">What SubSystems are</a></li>
    <li class="level2 nav-header">Platform &amp; IO</li>
    <li class="level3 nav-leaf"><a href="../../../documentation/05-platform/assets.html">Assets &amp; Asset Loading</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/05-platform/configuration.html">Game Configuration</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/05-platform/cross-platform-publishing.html">Cross Platform Publishing</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/05-platform/importers.html">File Importers</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/05-platform/input-handling.html">Input Handling</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/05-platform/loading-and-saving-data.html">Loading &amp; Saving Data</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/05-platform/logging.html">Logging</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/05-platform/networking.html">Networking</a></li>
    <li class="level2 nav-header">Presentation</li>
    <li class="level3 nav-leaf"><a href="../../../documentation/06-presentation/animation.html">Animation</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/06-presentation/audio.html">Audio</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/06-presentation/boundaries.html">Boundaries</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/06-presentation/cameras.html">Cameras</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/06-presentation/clones-and-mutants.html">Clones &amp; Mutants</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/06-presentation/depth.html">Depth</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/06-presentation/layers.html">Layers</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/06-presentation/lighting.html">Lighting</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/06-presentation/materials.html">Materials</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/06-presentation/primitives.html">Primitives &amp; Building Blocks</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/06-presentation/scene-update-fragment.html">SceneUpdateFragment</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/06-presentation/shapes.html">Shapes</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/06-presentation/text-and-fonts.html">Text &amp; Fonts</a></li>
    <li class="level2 nav-header">Shaders</li>
    <li class="level3 nav-leaf"><a href="../../../documentation/07-shaders/blending.html">Blending</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/07-shaders/constants.html">Shader Constants, Variables, and Outputs</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/07-shaders/premultiplied-alpha.html">Premultiplied Alpha</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/07-shaders/shaders-overview.html">Shaders Overview</a></li>
    <li class="level2 nav-header">Time</li>
    <li class="level3 nav-leaf"><a href="../../../documentation/08-time/gametime.html">GameTime</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/08-time/signals.html">Signals &amp; Signal Functions</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/08-time/time-varying-values.html">Time Varying Values</a></li>
    <li class="level2 nav-header">UI Components</li>
    <li class="level3 nav-leaf"><a href="../../../documentation/09-uicomponents/button.html">Buttons</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/09-uicomponents/hit-area.html">Hit Areas</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/09-uicomponents/input-field.html">Input Fields</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/09-uicomponents/radio-button.html">Radio Buttons</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/09-uicomponents/ui-components.html">UI Components</a></li>
    <li class="level2 nav-header">Misc</li>
    <li class="level3 nav-leaf"><a href="../../../documentation/10-information/alternatives.html">Alternatives to Indigo</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/10-information/antipatterns.html">Anti-Patterns</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/10-information/glossary.html">Glossary</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/10-information/key-concepts.html">Key Concepts</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/10-information/model-viewmodel-view.html">Model, ViewModel, &amp; View</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/10-information/motivation-and-constraints.html">Motivation &amp; Constraints</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/10-information/pathfinding.html">Path finding</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/10-information/performance.html">Performance</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/10-information/prior-art.html">Prior Art</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/10-information/rendering-technology.html">Rendering Technology</a></li>
    <li class="level2 nav-header">Physics</li>
    <li class="level3 nav-leaf"><a href="../../../documentation/11-physics/physics-overview.html">Physics Overview</a></li>
    <li class="level1 nav-node"><a href="../../">Examples</a></li>
    <li class="level2 nav-node"><a href="../../importers/">Importers</a></li>
    <li class="level3 nav-leaf"><a href="../../importers/tiled-loaded/">Loading Tiled maps at runtime</a></li>
    <li class="level2 nav-node"><a href="../../materials/">Materials</a></li>
    <li class="level3 nav-leaf"><a href="../../materials/bitmap/">Bitmap material</a></li>
    <li class="level3 nav-leaf"><a href="../../materials/filltypes/">Fill Types</a></li>
    <li class="level3 nav-leaf"><a href="../../materials/imageeffects/">ImageEffects material</a></li>
    <li class="level2 nav-node"><a href="../">Physics</a></li>
    <li class="level3 active nav-leaf"><a href="#">Basic Physics Example</a></li>
    <li class="level2 nav-node"><a href="../../primitives/">Primitives</a></li>
    <li class="level3 nav-leaf"><a href="../../primitives/graphic/">Graphic</a></li>
    <li class="level3 nav-leaf"><a href="../../primitives/text/">Text</a></li>
    <li class="level2 nav-node"><a href="../../shaders/">Shaders</a></li>
    <li class="level3 nav-leaf"><a href="../../shaders/basic/">A basic custom shader</a></li>
    <li class="level2 nav-node"><a href="../../ui/">Ui</a></li>
    <li class="level3 nav-leaf"><a href="../../ui/button/">UI Components: Button</a></li>
    <li class="level3 nav-leaf"><a href="../../ui/component-group/">UI Components: Component Group</a></li>
    <li class="level3 nav-leaf"><a href="../../ui/component-list/">UI Components: Component List</a></li>
    <li class="level3 nav-leaf"><a href="../../ui/custom/">UI Components: Custom Components</a></li>
    <li class="level3 nav-leaf"><a href="../../ui/hitarea/">UI Components: HitArea</a></li>
    <li class="level3 nav-leaf"><a href="../../ui/input/">UI Components: Label</a></li>
    <li class="level3 nav-leaf"><a href="../../ui/label/">UI Components: Label</a></li>
    <li class="level3 nav-leaf"><a href="../../ui/maskedpane/">UI Components: Masked Pane</a></li>
    <li class="level3 nav-leaf"><a href="../../ui/radiobuttons/">UI Components: Radio buttons</a></li>
    <li class="level3 nav-leaf"><a href="../../ui/scrollpane/">UI Components: Scroll Pane</a></li>
    <li class="level3 nav-leaf"><a href="../../ui/switch/">UI Components: Switch</a></li>
    <li class="level3 nav-leaf"><a href="../../ui/textarea/">UI Components: TextArea</a></li>
    <li class="level3 nav-leaf"><a href="../../ui/window/">UI Components: Windows</a></li>
  </ul>

</nav>

    <div id="container">

      
<nav id="page-nav">
  <p class="header"><a href="#">Basic Physics Example</a></p>

  <ul class="nav-list">
    <li class="level1 nav-leaf"><a href="#example-links">Example Links</a></li>
    <li class="level1 nav-node"><a href="#how-to-set-up-a-simple-physics-simulation">How to set up a simple physics simulation</a></li>
    <li class="level2 nav-leaf"><a href="#step-1-define-a-tag-for-each-type-of-object-in-the-simulation">Step 1: Define a tag for each type of object in the simulation</a></li>
    <li class="level2 nav-leaf"><a href="#step-2-define-a-model-for-the-simulation">Step 2: Define a model for the simulation</a></li>
    <li class="level2 nav-leaf"><a href="#step-3-defining-the-rest-of-the-game">Step 3: Defining the rest of the game.</a></li>
  </ul>

  <p class="footer"></p>
</nav>


      <main class="content">

        <h1 id="basic-physics-example" class="title">Basic Physics Example</h1>
        
        <h2 id="example-links" class="section"><a class="anchor-link left" href="#example-links"><i class="icofont-laika link">&#xef71;</i></a>Example Links</h2>
        <ul>
          <li><a href="https://github.com/PurpleKingdomGames/indigo-docs/blob/main/examples/physics/basics">Edit this page</a></li>
        </ul>
        <ul>
          <li><a href="https://purplekingdomgames.github.io/indigo-docs//demos/examples/physics/basics/">Live demo</a></li>
        </ul>
        
        <h2 id="how-to-set-up-a-simple-physics-simulation" class="section"><a class="anchor-link left" href="#how-to-set-up-a-simple-physics-simulation"><i class="icofont-laika link">&#xef71;</i></a>How to set up a simple physics simulation</h2>
        <p>This example shows how to set up and run a simple physics simulation in Indigo, and render the
        result.</p>
        
        <h3 id="step-1-define-a-tag-for-each-type-of-object-in-the-simulation" class="section"><a class="anchor-link left" href="#step-1-define-a-tag-for-each-type-of-object-in-the-simulation"><i class="icofont-laika link">&#xef71;</i></a>Step 1: Define a tag for each type of object in the simulation</h3>
        <p>Indigo&#39;s physics engine uses tags to identify different types of objects in the simulation. They
        are custom tags that you define and can be any type, such as a simepl String, but an ADT / enum
        is recommended.</p>
        <p>Tags are used to identify objects in the simulations, such as how they interact with one
        another, e.g. objects of tag x do not collide with objects of tag y, and also to help you when
        it comes to rendering and querying the simulation to find out what happened.</p>
        <p>In this example, we define two tags: <code>StaticCircle</code> and <code>Ball</code>. Static circles just sit there
        and balls are bouncy and subject to gravity.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="identifier">enum</span><span> </span><span class="type-name">MyTag</span><span>:
  </span><span class="keyword">case</span><span> </span><span class="type-name">StaticCircle</span><span>
  </span><span class="keyword">case</span><span> </span><span class="type-name">Ball</span></code></pre>
        
        <h3 id="step-2-define-a-model-for-the-simulation" class="section"><a class="anchor-link left" href="#step-2-define-a-model-for-the-simulation"><i class="icofont-laika link">&#xef71;</i></a>Step 2: Define a model for the simulation</h3>
        <p>This is the model for our game, and in this case mostly just holds the <code>World</code> instance.</p>
        <p>The <code>World</code> is the physics simulation itself, and is where all the magic happens. The key thing
        to appreciate about the World is that unlike in other game engines, the World is not mixed up
        with the rest of the model or any of the view code. It is an entirely self-contained simultation
        of &#39;colliders&#39;.</p>
        <p>When you want to render something in the world, you query the world for the colliders you are
        interested in and then render them however you like. That isn&#39;t quite what we&#39;ll do in this
        demo, as the world also has a <code>present</code> method that can use to render everything in the
        simulatation. Generally using the world <code>present</code> isn&#39;t the intended use, but it is very useful
        for debugging since it allows you to &#39;see&#39; where all the colliders are in relation to your
        normal view elements.</p>
        <p>A quick note on the &#39;running&#39; Boolean. This isn&#39;t just convenient, it serves a practical purpose
        in this demo. Normally, you wouldn&#39;t be running a simulation the instant you start a game, you&#39;d
        probably at least show a title screen. Since we&#39;re going straight into it, the game will &#39;start&#39;
        before everything is really, and it will start with an initially volatile framerate, throwing
        the simulation off. To get around this, we&#39;ll pause the simulation until the user presses SPACE.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">final</span><span> </span><span class="keyword">case</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">Model</span><span>(</span><span class="identifier">running</span><span>: </span><span class="type-name">Boolean</span><span>, </span><span class="identifier">world</span><span>: </span><span class="type-name">World</span><span>[</span><span class="type-name">MyTag</span><span>])</span></code></pre>
        <p>We&#39;ll initialise the model and the world in the companion object for the model.</p>
        <p>The world is initialised in an empty state with a given size. We then add some forces to
        simulate gravity in &quot;units per second&quot;, units in this case being pixels. The simulation does not
        care what scale you want to model it at, and often it helps to use a &#39;world space&#39; that suits
        you domain model. In this case we&#39;ve made the size the same as the game screen size, so the
        units are 1:1 with pixels, which makes rendering simpler.</p>
        <p>We also add some resistance to the simulation, which will slow down the balls over time but
        causing them to globally lose energy.</p>
        <p>Elements within the simulation are known as &#39;colliders&#39;. Indigo only supports two types of
        collider at present: circles and boxes, and both are &#39;axis aligned&#39;, meaning they do not rotate.
        Limited, but good enough for many games, we hope to expand on this later.</p>
        <p>Colliders have many properties, but the two we care about here are <code>makeStatic</code> and restitution.</p>
        <p><code>makeStatic</code> is a method that tells the simulation that the collider does not move, and that no
        calculation is required for it. The obvious use in a video game is for walls and floors, but you
        can also use it for elements that, for example, a user is dragging / moving that affect the
        world.</p>
        <p>Restitution determines how bouncy an object is. A value of 1.0 means the object will bounce back
        perfectly, here we&#39;ve set it to 0.8 so that it&#39;s bouncy, but loses energy with each impact.</p>
        <pre><code class="nohighlight"><span class="keyword">object</span><span> </span><span class="type-name">Model</span><span>:

  </span><span class="keyword">def</span><span> </span><span class="declaration-name">initial</span><span>: </span><span class="type-name">Model</span><span> =
    </span><span class="type-name">Model</span><span>(</span><span class="boolean-literal">false</span><span>, </span><span class="identifier">world</span><span>)

  </span><span class="keyword">def</span><span> </span><span class="declaration-name">world</span><span>: </span><span class="type-name">World</span><span>[</span><span class="type-name">MyTag</span><span>] =
    </span><span class="keyword">val</span><span> </span><span class="identifier">staticCircles</span><span> =
      (</span><span class="number-literal">0</span><span> </span><span class="identifier">to</span><span> </span><span class="number-literal">8</span><span>).</span><span class="identifier">toBatch</span><span>.</span><span class="identifier">map</span><span> { </span><span class="identifier">i</span><span> =&gt;
        </span><span class="type-name">Collider</span><span>(
          </span><span class="type-name">MyTag</span><span>.</span><span class="type-name">StaticCircle</span><span>,
          </span><span class="type-name">BoundingCircle</span><span>(</span><span class="identifier">i</span><span>.</span><span class="identifier">toDouble</span><span> * </span><span class="number-literal">100</span><span> + </span><span class="number-literal">30</span><span>, </span><span class="number-literal">200.0</span><span>, </span><span class="number-literal">20.0</span><span>)
        ).</span><span class="identifier">makeStatic</span><span>
      }

    </span><span class="keyword">val</span><span> </span><span class="identifier">balls</span><span> =
      (</span><span class="number-literal">0</span><span> </span><span class="identifier">to</span><span> </span><span class="number-literal">15</span><span>).</span><span class="identifier">toBatch</span><span>.</span><span class="identifier">map</span><span> { </span><span class="identifier">i</span><span> =&gt;
        </span><span class="type-name">Collider</span><span>(
          </span><span class="type-name">MyTag</span><span>.</span><span class="type-name">Ball</span><span>,
          </span><span class="type-name">BoundingCircle</span><span>(
            </span><span class="identifier">i</span><span>.</span><span class="identifier">toDouble</span><span> * </span><span class="number-literal">50</span><span> + </span><span class="number-literal">28</span><span>,
            (</span><span class="keyword">if</span><span> </span><span class="identifier">i</span><span> % </span><span class="number-literal">2</span><span> == </span><span class="number-literal">0</span><span> </span><span class="identifier">then</span><span> </span><span class="number-literal">20</span><span> </span><span class="keyword">else</span><span> </span><span class="number-literal">40</span><span>) + </span><span class="identifier">i</span><span>.</span><span class="identifier">toDouble</span><span> * </span><span class="number-literal">2</span><span>,
            </span><span class="number-literal">15.0</span><span>
          )
        )
          .</span><span class="identifier">withRestitution</span><span>(</span><span class="type-name">Restitution</span><span>(</span><span class="number-literal">0.8</span><span>))
      }

    </span><span class="type-name">World</span><span>
      .</span><span class="identifier">empty</span><span>[</span><span class="type-name">MyTag</span><span>](</span><span class="type-name">SimulationSettings</span><span>(</span><span class="type-name">BoundingBox</span><span>(</span><span class="number-literal">0</span><span>, </span><span class="number-literal">0</span><span>, </span><span class="number-literal">800</span><span>, </span><span class="number-literal">600</span><span>)))
      .</span><span class="identifier">addForces</span><span>(</span><span class="type-name">Vector2</span><span>(</span><span class="number-literal">0</span><span>, </span><span class="number-literal">600</span><span>))
      .</span><span class="identifier">withResistance</span><span>(</span><span class="type-name">Resistance</span><span>(</span><span class="number-literal">0.01</span><span>))
      .</span><span class="identifier">withColliders</span><span>(</span><span class="identifier">staticCircles</span><span>)
      .</span><span class="identifier">addColliders</span><span>(
        </span><span class="type-name">Collider</span><span>(</span><span class="type-name">MyTag</span><span>.</span><span class="type-name">StaticCircle</span><span>, </span><span class="type-name">BoundingCircle</span><span>(-</span><span class="number-literal">100.0d</span><span>, </span><span class="number-literal">700.0</span><span>, </span><span class="number-literal">300.0</span><span>)).</span><span class="identifier">makeStatic</span><span>,
        </span><span class="type-name">Collider</span><span>(</span><span class="type-name">MyTag</span><span>.</span><span class="type-name">StaticCircle</span><span>, </span><span class="type-name">BoundingCircle</span><span>(</span><span class="number-literal">900.0d</span><span>, </span><span class="number-literal">700.0</span><span>, </span><span class="number-literal">300.0</span><span>)).</span><span class="identifier">makeStatic</span><span>,
        </span><span class="type-name">Collider</span><span>(</span><span class="type-name">MyTag</span><span>.</span><span class="type-name">StaticCircle</span><span>, </span><span class="type-name">BoundingCircle</span><span>(</span><span class="number-literal">400.0d</span><span>, </span><span class="number-literal">800.0</span><span>, </span><span class="number-literal">300.0</span><span>)).</span><span class="identifier">makeStatic</span><span>
      )
      .</span><span class="identifier">addColliders</span><span>(</span><span class="identifier">balls</span><span>)</span></code></pre>
        
        <h3 id="step-3-defining-the-rest-of-the-game" class="section"><a class="anchor-link left" href="#step-3-defining-the-rest-of-the-game"><i class="icofont-laika link">&#xef71;</i></a>Step 3: Defining the rest of the game.</h3>
        <p>We&#39;ll need to actually initialise our model.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">initialModel</span><span>(</span><span class="identifier">startupData</span><span>: </span><span class="type-name">Unit</span><span>): </span><span class="type-name">Outcome</span><span>[</span><span class="type-name">Model</span><span>] =
  </span><span class="type-name">Outcome</span><span>(</span><span class="type-name">Model</span><span>.</span><span class="identifier">initial</span><span>)</span></code></pre>
        <p>Then during update, if the game is running, update the simulation by supplying the frame delta
        time, and updating the model with the new version of the world.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span>  </span><span class="keyword">def</span><span> </span><span class="declaration-name">updateModel</span><span>(</span><span class="identifier">context</span><span>: </span><span class="type-name">Context</span><span>[</span><span class="type-name">Unit</span><span>], </span><span class="identifier">model</span><span>: </span><span class="type-name">Model</span><span>): </span><span class="type-name">GlobalEvent</span><span> =&gt; </span><span class="type-name">Outcome</span><span>[</span><span class="type-name">Model</span><span>] =
    </span><span class="keyword">case</span><span> </span><span class="type-name">FrameTick</span><span> </span><span class="keyword">if</span><span> </span><span class="identifier">model</span><span>.</span><span class="identifier">running</span><span> =&gt;
      </span><span class="identifier">model</span><span>.</span><span class="identifier">world</span><span>
        .</span><span class="identifier">update</span><span>(</span><span class="identifier">context</span><span>.</span><span class="identifier">frame</span><span>.</span><span class="identifier">time</span><span>.</span><span class="identifier">delta</span><span>)
        .</span><span class="identifier">map</span><span>(</span><span class="identifier">updated</span><span> =&gt; </span><span class="identifier">model</span><span>.</span><span class="identifier">copy</span><span>(</span><span class="identifier">world</span><span> = </span><span class="identifier">updated</span><span>))

    </span><span class="keyword">case</span><span> </span><span class="type-name">KeyboardEvent</span><span>.</span><span class="type-name">KeyUp</span><span>(</span><span class="type-name">Key</span><span>.</span><span class="type-name">SPACE</span><span>) =&gt;
      </span><span class="type-name">Outcome</span><span>(</span><span class="identifier">model</span><span>.</span><span class="identifier">copy</span><span>(</span><span class="identifier">running</span><span> = !</span><span class="identifier">model</span><span>.</span><span class="identifier">running</span><span>))

    </span><span class="keyword">case</span><span> </span><span class="identifier">_</span><span> =&gt;
      </span><span class="type-name">Outcome</span><span>(</span><span class="identifier">model</span><span>)</span></code></pre>
        <p>Finally we&#39;ll present the simulation using the <code>world.present</code> function, which will
        conveniently allow us to render all the colliders in the simulation. In this case we&#39;ll
        produce a <code>Batch</code> of <code>Shapes</code> for ease.</p>
        <p>Below that, the flashing text is created using a <code>Signal</code> that pulses every second and renders
        the text, or not.</p>
        <pre><code class="nohighlight"><span>  </span><span class="keyword">def</span><span> </span><span class="declaration-name">present</span><span>(</span><span class="identifier">context</span><span>: </span><span class="type-name">Context</span><span>[</span><span class="type-name">Unit</span><span>], </span><span class="identifier">model</span><span>: </span><span class="type-name">Model</span><span>): </span><span class="type-name">Outcome</span><span>[</span><span class="type-name">SceneUpdateFragment</span><span>] =
    </span><span class="type-name">Outcome</span><span>(
      </span><span class="type-name">SceneUpdateFragment</span><span>(
        </span><span class="identifier">model</span><span>.</span><span class="identifier">world</span><span>.</span><span class="identifier">present</span><span> {
          </span><span class="keyword">case</span><span> </span><span class="type-name">Collider</span><span>.</span><span class="type-name">Circle</span><span>(</span><span class="identifier">_</span><span>, </span><span class="identifier">bounds</span><span>, </span><span class="identifier">_</span><span>, </span><span class="identifier">_</span><span>, </span><span class="identifier">_</span><span>, </span><span class="identifier">_</span><span>, </span><span class="identifier">_</span><span>, </span><span class="identifier">_</span><span>, </span><span class="identifier">_</span><span>, </span><span class="identifier">_</span><span>) =&gt;
            </span><span class="type-name">Shape</span><span>.</span><span class="type-name">Circle</span><span>(
              </span><span class="identifier">bounds</span><span>.</span><span class="identifier">position</span><span>.</span><span class="identifier">toPoint</span><span>,
              </span><span class="identifier">bounds</span><span>.</span><span class="identifier">radius</span><span>.</span><span class="identifier">toInt</span><span>,
              </span><span class="type-name">Fill</span><span>.</span><span class="type-name">Color</span><span>(</span><span class="type-name">RGBA</span><span>.</span><span class="type-name">White</span><span>.</span><span class="identifier">withAlpha</span><span>(</span><span class="number-literal">0.2</span><span>)),
              </span><span class="type-name">Stroke</span><span>(</span><span class="number-literal">1</span><span>, </span><span class="type-name">RGBA</span><span>.</span><span class="type-name">White</span><span>)
            )

          </span><span class="keyword">case</span><span> </span><span class="type-name">Collider</span><span>.</span><span class="type-name">Box</span><span>(</span><span class="identifier">_</span><span>, </span><span class="identifier">bounds</span><span>, </span><span class="identifier">_</span><span>, </span><span class="identifier">_</span><span>, </span><span class="identifier">_</span><span>, </span><span class="identifier">_</span><span>, </span><span class="identifier">_</span><span>, </span><span class="identifier">_</span><span>, </span><span class="identifier">_</span><span>, </span><span class="identifier">_</span><span>) =&gt;
            </span><span class="type-name">Shape</span><span>.</span><span class="type-name">Box</span><span>(
              </span><span class="identifier">bounds</span><span>.</span><span class="identifier">toRectangle</span><span>,
              </span><span class="type-name">Fill</span><span>.</span><span class="type-name">Color</span><span>(</span><span class="type-name">RGBA</span><span>.</span><span class="type-name">White</span><span>.</span><span class="identifier">withAlpha</span><span>(</span><span class="number-literal">0.2</span><span>)),
              </span><span class="type-name">Stroke</span><span>(</span><span class="number-literal">1</span><span>, </span><span class="type-name">RGBA</span><span>.</span><span class="type-name">White</span><span>)
            )
        } ++
          </span><span class="type-name">Signal</span><span>
            .</span><span class="type-name">Pulse</span><span>(</span><span class="number-literal">1</span><span>.</span><span class="identifier">seconds</span><span>)
            .</span><span class="identifier">map</span><span> { </span><span class="identifier">show</span><span> =&gt;
              </span><span class="keyword">if</span><span> </span><span class="identifier">show</span><span> </span><span class="identifier">then</span><span>
                </span><span class="keyword">val</span><span> </span><span class="identifier">bounds</span><span> = </span><span class="identifier">context</span><span>.</span><span class="identifier">services</span><span>.</span><span class="identifier">bounds</span><span>.</span><span class="identifier">find</span><span>(</span><span class="identifier">message</span><span>).</span><span class="identifier">getOrElse</span><span>(</span><span class="type-name">Rectangle</span><span>.</span><span class="identifier">zero</span><span>)

                </span><span class="type-name">Batch</span><span>(
                  </span><span class="identifier">message</span><span>.</span><span class="identifier">moveTo</span><span>((</span><span class="number-literal">800</span><span> - </span><span class="identifier">bounds</span><span>.</span><span class="identifier">width</span><span>) / </span><span class="number-literal">2</span><span>, </span><span class="number-literal">600</span><span> - </span><span class="identifier">bounds</span><span>.</span><span class="identifier">height</span><span> - </span><span class="number-literal">10</span><span>)
                )
              </span><span class="keyword">else</span><span> </span><span class="type-name">Batch</span><span>.</span><span class="identifier">empty</span><span>
            }
            .</span><span class="identifier">at</span><span>(</span><span class="identifier">context</span><span>.</span><span class="identifier">frame</span><span>.</span><span class="identifier">time</span><span>.</span><span class="identifier">running</span><span>)
      )
    )</span></code></pre>

        
<hr class="footer-rule"/>
<footer>
  Site generated by <a href="https://typelevel.org/Laika/">Laika</a> with the Helium theme.
</footer>


      </main>

    </div>

  </body>

</html>