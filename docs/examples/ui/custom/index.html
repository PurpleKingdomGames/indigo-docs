<!DOCTYPE html>
<html lang="en">
  
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Typelevel Laika + Helium Theme" />
  <title>UI Components: Custom Components</title>
  
  
  <meta name="description" content="An FP game engine for Scala."/>
  
  
  
  <link rel="icon" sizes="32x32" type="image/png" href="../../../img/favicon.png"/>
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700">
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono:500">
  
  <link rel="stylesheet" type="text/css" href="../../../helium/site/icofont.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../helium/site/laika-helium.css" />
    <link rel="stylesheet" type="text/css" href="../../../css/custom.css" />
  <script src="../../../helium/site/laika-helium.js"></script>
  
  
  <script> /* for avoiding page load transitions */ </script>
</head>

  <body>

    <header id="top-bar" class="light-default dark-default">

  <div class="row">
    <a id="nav-icon">
      <i class="icofont-laika navigationMenu" title="Navigation">&#xefa2;</i>
    </a>
    
    
  </div>

  <a class="image-link" href="../../../documentation/"><img src="../../../img/indigo_logo_solid_text.svg" alt="An FP game engine for Scala." title="Indigo" width="150" height="50"></a>

  <div class="row links">
    
    <a class="button-link" href="https://purplekingdomgames.github.io/indigo-docs/demos">Live Demos</a>
    
    <a class="button-link" href="https://discord.gg/b5CD47g">Discord</a>
    
    <a class="button-link" href="https://github.com/PurpleKingdomGames/indigo">Github</a>
    
  </div>  

</header>
    
    <nav id="sidebar">

  <div class="row">
    
    <a class="button-link" href="https://purplekingdomgames.github.io/indigo-docs/demos">Live Demos</a>
    
    <a class="button-link" href="https://discord.gg/b5CD47g">Discord</a>
    
    <a class="button-link" href="https://github.com/PurpleKingdomGames/indigo">Github</a>
    
  </div>

  <ul class="nav-list">
    <li class="level1 nav-leaf"><a href="../../../documentation/">Indigo</a></li>
    <li class="level1 nav-node"><a href="../../">Examples</a></li>
    <li class="level2 nav-node"><a href="../../importers/">Importers</a></li>
    <li class="level3 nav-leaf"><a href="../../importers/tiled-loaded/">Loading Tiled maps at runtime</a></li>
    <li class="level2 nav-node"><a href="../../materials/">Materials</a></li>
    <li class="level3 nav-leaf"><a href="../../materials/bitmap/">Bitmap material</a></li>
    <li class="level3 nav-leaf"><a href="../../materials/filltypes/">Fill Types</a></li>
    <li class="level3 nav-leaf"><a href="../../materials/imageeffects/">ImageEffects material</a></li>
    <li class="level2 nav-node"><a href="../../physics/">Physics</a></li>
    <li class="level3 nav-leaf"><a href="../../physics/basics/">Basic Physics Example</a></li>
    <li class="level2 nav-node"><a href="../../primitives/">Primitives</a></li>
    <li class="level3 nav-leaf"><a href="../../primitives/graphic/">Graphic</a></li>
    <li class="level3 nav-leaf"><a href="../../primitives/text/">Text</a></li>
    <li class="level2 nav-node"><a href="../../shaders/">Shaders</a></li>
    <li class="level3 nav-leaf"><a href="../../shaders/basic/">A basic custom shader</a></li>
    <li class="level2 nav-node"><a href="../">Ui</a></li>
    <li class="level3 nav-leaf"><a href="../button/">UI Components: Button</a></li>
    <li class="level3 nav-leaf"><a href="../component-group/">UI Components: Component Group</a></li>
    <li class="level3 nav-leaf"><a href="../component-list/">UI Components: Component List</a></li>
    <li class="level3 active nav-leaf"><a href="#">UI Components: Custom Components</a></li>
    <li class="level3 nav-leaf"><a href="../hitarea/">UI Components: HitArea</a></li>
    <li class="level3 nav-leaf"><a href="../input/">UI Components: Input</a></li>
    <li class="level3 nav-leaf"><a href="../label/">UI Components: Label</a></li>
    <li class="level3 nav-leaf"><a href="../maskedpane/">UI Components: Masked Pane</a></li>
    <li class="level3 nav-leaf"><a href="../radiobuttons/">UI Components: Radio buttons</a></li>
    <li class="level3 nav-leaf"><a href="../scrollpane/">UI Components: Scroll Pane</a></li>
    <li class="level3 nav-leaf"><a href="../switch/">UI Components: Switch</a></li>
    <li class="level3 nav-leaf"><a href="../textarea/">UI Components: TextArea</a></li>
    <li class="level3 nav-leaf"><a href="../window/">UI Components: Windows</a></li>
  </ul>

</nav>

    <div id="container">

      
<nav id="page-nav">
  <p class="header"><a href="#">UI Components: Custom Components</a></p>

  <ul class="nav-list">
    <li class="level1 nav-leaf"><a href="#example-links">Example Links</a></li>
    <li class="level1 nav-node"><a href="#how-to-create-a-custom-component">How to create a custom component</a></li>
    <li class="level2 nav-leaf"><a href="#defining-our-component-s-behaviour-by-defining-its-data-model">Defining our component&#39;s behaviour by defining its data model</a></li>
    <li class="level2 nav-leaf"><a href="#defining-our-component-s-behaviour-by-defining-its-component-instance">Defining our component&#39;s behaviour by defining its <code>Component</code> instance</a></li>
    <li class="level2 nav-leaf"><a href="#using-our-custom-component">Using our custom component</a></li>
  </ul>

  <p class="footer"></p>
</nav>


      <main class="content">

        <h1 id="ui-components-custom-components" class="title">UI Components: Custom Components</h1>
        <p>In this example we define a completely custom component that (for reasons unknown) draws a magenta circle that fits the available space, and then render our component as the only content inside a window, just to prove it works.</p>
        
        <h2 id="example-links" class="section"><a class="anchor-link left" href="#example-links"><i class="icofont-laika link">&#xef71;</i></a>Example Links</h2>
        <ul>
          <li><a href="https://github.com/PurpleKingdomGames/indigo-docs/blob/main/examples/ui/custom">View example code</a></li>
        </ul>
        <ul>
          <li><a href="https://purplekingdomgames.github.io/indigo-docs//demos/examples/ui/custom/">Live demo</a></li>
        </ul>
        
        <h2 id="how-to-create-a-custom-component" class="section"><a class="anchor-link left" href="#how-to-create-a-custom-component"><i class="icofont-laika link">&#xef71;</i></a>How to create a custom component</h2>
        <p>To make a custom component we need two things:</p>
        <ol class="arabic">
          <li>A data structure representing the state of the component.</li>
          <li>A <code>Component</code> instance that explains how our data structure can be used to describe a
          component.</li>
        </ol>
        
        <h3 id="defining-our-component-s-behaviour-by-defining-its-data-model" class="section"><a class="anchor-link left" href="#defining-our-component-s-behaviour-by-defining-its-data-model"><i class="icofont-laika link">&#xef71;</i></a>Defining our component&#39;s behaviour by defining its data model</h3>
        <p>We will create a very simple component that draws a coloured circle in the available space. We
        infer from the name that we&#39;re doing something with a circle, but in terms of data there&#39;s only
        two things we really need:</p>
        <ol class="arabic">
          <li>The colour the circle is going to be. This value won&#39;t change.</li>
          <li>The bounds of the circle. This value is a more active bit of state that will change as our
          component&#39;s parent is resized and the available space is cascaded down to our component.</li>
        </ol>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">final</span><span> </span><span class="keyword">case</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">ColourfulCircle</span><span>(</span><span class="identifier">colour</span><span>: </span><span class="type-name">RGBA</span><span>, </span><span class="identifier">bounds</span><span>: </span><span class="type-name">Bounds</span><span>)</span></code></pre>
        
        <h3 id="defining-our-component-s-behaviour-by-defining-its-component-instance" class="section"><a class="anchor-link left" href="#defining-our-component-s-behaviour-by-defining-its-component-instance"><i class="icofont-laika link">&#xef71;</i></a>Defining our component&#39;s behaviour by defining its <code>Component</code> instance</h3>
        <p>We need to define a <code>Component</code> instance for our <code>ColourfulCircle</code> data structure. This instance
        will tell Indigo how to:</p>
        <ol class="arabic">
          <li>Calculate the bounds of the component.</li>
          <li>Update the model.</li>
          <li>Present the component.</li>
          <li>Refresh the component.</li>
        </ol>
        <p>The astute reader will notice that what we have here is a mini-TEA architecture. That&#39;s right, a
        component is like a mini indigo game all by itself! It has initial state, a pure function to
        update the state based on the previous state and an event, and a pure function to present the
        state.</p>
        <p>The only things that are perhaps new, are the bounds function and the refresh function. These
        two functions are essential because the allow the UI system to iterogate the component hierarchy
        for the bounds of each component in order to do layout calculations, and in turn, to pass new
        layout information back down to the components.</p>
        <p>In this example, the bounds is the stored value and we do no updates in response to events. The
        interesting functions are <code>present</code> and <code>refresh</code>, where we draw the circle based on the model
        data, and update the bounds based on the parent, respectively.</p>
        <pre><code class="nohighlight"><span class="keyword">object</span><span> </span><span class="type-name">ColourfulCircle</span><span>:

  </span><span class="identifier">given</span><span> </span><span class="type-name">Component</span><span>[</span><span class="type-name">ColourfulCircle</span><span>, </span><span class="type-name">Unit</span><span>]:
    </span><span class="keyword">def</span><span> </span><span class="declaration-name">bounds</span><span>(</span><span class="identifier">context</span><span>: </span><span class="type-name">UIContext</span><span>[</span><span class="type-name">Unit</span><span>], </span><span class="identifier">model</span><span>: </span><span class="type-name">ColourfulCircle</span><span>): </span><span class="type-name">Bounds</span><span> =
      </span><span class="identifier">model</span><span>.</span><span class="identifier">bounds</span><span>

    </span><span class="keyword">def</span><span> </span><span class="declaration-name">updateModel</span><span>(
        </span><span class="identifier">context</span><span>: </span><span class="type-name">UIContext</span><span>[</span><span class="type-name">Unit</span><span>],
        </span><span class="identifier">model</span><span>: </span><span class="type-name">ColourfulCircle</span><span>
    ): </span><span class="type-name">GlobalEvent</span><span> =&gt; </span><span class="type-name">Outcome</span><span>[</span><span class="type-name">ColourfulCircle</span><span>] =
      </span><span class="keyword">case</span><span> </span><span class="identifier">_</span><span> =&gt;
        </span><span class="type-name">Outcome</span><span>(</span><span class="identifier">model</span><span>)

    </span><span class="keyword">def</span><span> </span><span class="declaration-name">present</span><span>(
        </span><span class="identifier">context</span><span>: </span><span class="type-name">UIContext</span><span>[</span><span class="type-name">Unit</span><span>],
        </span><span class="identifier">model</span><span>: </span><span class="type-name">ColourfulCircle</span><span>
    ): </span><span class="type-name">Outcome</span><span>[</span><span class="type-name">Layer</span><span>] =
      </span><span class="type-name">Outcome</span><span>(
        </span><span class="type-name">Layer</span><span>(
          </span><span class="type-name">Shape</span><span>
            .</span><span class="type-name">Circle</span><span>(
              </span><span class="type-name">Circle</span><span>(
                </span><span class="type-name">Point</span><span>.</span><span class="identifier">zero</span><span>,
                </span><span class="keyword">if</span><span> </span><span class="identifier">model</span><span>.</span><span class="identifier">bounds</span><span>.</span><span class="identifier">width</span><span> &lt; </span><span class="identifier">model</span><span>.</span><span class="identifier">bounds</span><span>.</span><span class="identifier">height</span><span> </span><span class="identifier">then</span><span> </span><span class="identifier">model</span><span>.</span><span class="identifier">bounds</span><span>.</span><span class="identifier">width</span><span> / </span><span class="number-literal">2</span><span>
                </span><span class="keyword">else</span><span> </span><span class="identifier">model</span><span>.</span><span class="identifier">bounds</span><span>.</span><span class="identifier">height</span><span> / </span><span class="number-literal">2</span><span>
              ),
              </span><span class="type-name">Fill</span><span>.</span><span class="type-name">Color</span><span>(</span><span class="identifier">model</span><span>.</span><span class="identifier">colour</span><span>)
            )
            .</span><span class="identifier">moveTo</span><span>(</span><span class="identifier">context</span><span>.</span><span class="identifier">parent</span><span>.</span><span class="identifier">bounds</span><span>.</span><span class="identifier">center</span><span>.</span><span class="identifier">unsafeToPoint</span><span>)
        )
      )

    </span><span class="keyword">def</span><span> </span><span class="declaration-name">refresh</span><span>(
        </span><span class="identifier">context</span><span>: </span><span class="type-name">UIContext</span><span>[</span><span class="type-name">Unit</span><span>],
        </span><span class="identifier">model</span><span>: </span><span class="type-name">ColourfulCircle</span><span>
    ): </span><span class="type-name">ColourfulCircle</span><span> =
      </span><span class="identifier">model</span><span>.</span><span class="identifier">copy</span><span>(</span><span class="identifier">bounds</span><span> = </span><span class="identifier">model</span><span>.</span><span class="identifier">bounds</span><span>.</span><span class="identifier">resize</span><span>(</span><span class="identifier">context</span><span>.</span><span class="identifier">parent</span><span>.</span><span class="identifier">bounds</span><span>.</span><span class="identifier">dimensions</span><span>))</span></code></pre>
        
        <h3 id="using-our-custom-component" class="section"><a class="anchor-link left" href="#using-our-custom-component"><i class="icofont-laika link">&#xef71;</i></a>Using our custom component</h3>
        <p>With our custom component defined, we can now use it by adding it to a <code>ComponentGroup</code> (or a
        <code>ComponentList</code>, or even directly to a <code>Window</code>). This works, because the <code>add</code> function will
        take <em>anything</em> that has a <code>given</code> (AKA <code>implicit</code>) instance of a component, which we made
        earlier.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">content</span><span>: </span><span class="type-name">ComponentGroup</span><span>[</span><span class="type-name">Unit</span><span>] =
  </span><span class="type-name">ComponentGroup</span><span>()
    .</span><span class="identifier">withBoundsMode</span><span>(</span><span class="type-name">BoundsMode</span><span>.</span><span class="identifier">inherit</span><span>)
    .</span><span class="identifier">withLayout</span><span>(</span><span class="type-name">ComponentLayout</span><span>.</span><span class="type-name">Horizontal</span><span>())
    .</span><span class="identifier">add</span><span>(</span><span class="type-name">ColourfulCircle</span><span>(</span><span class="type-name">RGBA</span><span>.</span><span class="type-name">Magenta</span><span>, </span><span class="type-name">Bounds</span><span>.</span><span class="identifier">zero</span><span>))</span></code></pre>

        
<hr class="footer-rule"/>
<footer>
  Site generated by <a href="https://typelevel.org/Laika/">Laika</a> with the Helium theme.
</footer>


      </main>

    </div>

  </body>

</html>